B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=10.3
@EndOfDesignText@
#IgnoreWarnings:12
#DesignerProperty: Key: ParentID, DisplayName: ParentID, FieldType: String, DefaultValue: pageview, Description: The ParentID of this page
#DesignerProperty: Key: ClearParent, DisplayName: Clear Parent, FieldType: Boolean, DefaultValue: False, Description: Clear Parent First
'#DesignerProperty: Key: PageName, DisplayName: Page Name*, FieldType: String, DefaultValue: page1, Description: The unique name of the page this should match your module 'name' variable
#DesignerProperty: Key: Active, DisplayName: Active Page, FieldType: Boolean, DefaultValue: True, Description: Active Page
#DesignerProperty: Key: Title, DisplayName: Title, FieldType: String, DefaultValue: My SDUIPage, Description: Title of the page
#DesignerProperty: Key: Icon, DisplayName: Icon, FieldType: String, DefaultValue: fa-solid fa-swatchbook, Description: Icon of the page
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue: #000000, Description: Color of the page
#DesignerProperty: Key: RawDescription, DisplayName: Description, FieldType: String, DefaultValue: My SDUIPage, Description: Description Of The Page
#DesignerProperty: Key: RawKeywords, DisplayName: Keywords, FieldType: String, DefaultValue: page, Description: Keywords Of The Page
#DesignerProperty: Key: BackgroundImage, DisplayName: BackgroundImage, FieldType: String, DefaultValue: , Description: The background image of the page
#DesignerProperty: Key: BackgroundColor, DisplayName: Background Color, FieldType: String, DefaultValue: base-100, Description: Background Color
#DesignerProperty: Key: FullPage, DisplayName: FullPage, FieldType: Boolean, DefaultValue: False, Description: w-full & h-full
#DesignerProperty: Key: FullScreen, DisplayName: FullScreen, FieldType: Boolean, DefaultValue: False, Description: w-screen & h-screen
#DesignerProperty: Key: ResizePageView, DisplayName: Resize PageView, FieldType: Boolean, DefaultValue: True, Description: Resize PageView
#DesignerProperty: Key: Container, DisplayName: Container, FieldType: Boolean, DefaultValue: True, Description: Container
#DesignerProperty: Key: CenterChildren, DisplayName: Center Children, FieldType: Boolean, DefaultValue: False, Description: Center Children
#DesignerProperty: Key: MxAuto, DisplayName: Mx Auto, FieldType: Boolean, DefaultValue: True, Description: Mx-auto
#DesignerProperty: Key: Flex, DisplayName: Flex, FieldType: Boolean, DefaultValue: True, Description: Flex - item after another
#DesignerProperty: Key: FlexCol, DisplayName: Flex Col, FieldType: Boolean, DefaultValue: False, Description: FlexCol
#DesignerProperty: Key: Columns, DisplayName: # of Columns, FieldType: String, DefaultValue: , Description: Number Of Columns Within An Element
#DesignerProperty: Key: FlexWrap, DisplayName: Flex Wrap, FieldType: Boolean, DefaultValue: True, Description: Wrap Overflow Contents
#DesignerProperty: Key: Gap, DisplayName: Gap, FieldType: String, DefaultValue: , Description: Gap Between Items
#DesignerProperty: Key: Grid, DisplayName: Grid, FieldType: Boolean, DefaultValue: False, Description: Grid (disable flex)
#DesignerProperty: Key: GridCols, DisplayName: Grid Cols, FieldType: String, DefaultValue: , Description: Grid Columns
#DesignerProperty: Key: DeviceGridCols, DisplayName: Device Grid Cols, FieldType: String, DefaultValue: xs=?; sm=?; md=?; lg=?; xl=?, Description: Grid Cols Per Device xs=?; sm=?; md=?; lg=?; xl=?
#DesignerProperty: Key: Glass, DisplayName: Glass, FieldType: Boolean, DefaultValue: False, Description: Glass
#DesignerProperty: Key: TextColor, DisplayName: Text Color, FieldType: String, DefaultValue: , Description: Text Color
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: , Description: Width
#DesignerProperty: Key: MinW, DisplayName: Min Width, FieldType: String, DefaultValue: , Description: MinW
#DesignerProperty: Key: MaxW, DisplayName: Max Width, FieldType: String, DefaultValue: , Description: MaxW
#DesignerProperty: Key: WFull, DisplayName: Full Width, FieldType: Boolean, DefaultValue: False, Description: WFull
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: , Description: Height
#DesignerProperty: Key: MinH, DisplayName: Min Height, FieldType: String, DefaultValue: , Description: MinH
#DesignerProperty: Key: MaxH, DisplayName: Max Height, FieldType: String, DefaultValue: , Description: MaxH
#DesignerProperty: Key: HFull, DisplayName: Full Height, FieldType: Boolean, DefaultValue: False, Description: HFull
#DesignerProperty: Key: AsForm, DisplayName: AsForm, FieldType: Boolean, DefaultValue: False, Description: As Form
#DesignerProperty: Key: Rounded, DisplayName: Rounded, FieldType: String, DefaultValue: none, Description: Rounded, List: 0|2xl|3xl|full|lg|md|none|rounded|sm|xl
#DesignerProperty: Key: Shadow, DisplayName: Shadow, FieldType: String, DefaultValue: none, Description: Shadow, List: 2xl|inner|lg|md|none|shadow|sm|xl
#DesignerProperty: Key: Visible, DisplayName: Visible, FieldType: Boolean, DefaultValue: True, Description: If visible.
#DesignerProperty: Key: GradientActive, DisplayName: GradientActive, FieldType: Boolean, DefaultValue: false, Description: Gradient should be set
#DesignerProperty: Key: Gradient, DisplayName: Gradient, FieldType: String, DefaultValue: , Description: Gradient, List: bl_tr|bottom_top|br_tl|left_right|right_left|tl_br|top_bottom|tr_bl
#DesignerProperty: Key: GradientColor1, DisplayName: GradientColor1, FieldType: Color, DefaultValue: #f86194, Gradient Color 1.
#DesignerProperty: Key: GradientColor2, DisplayName: GradientColor2, FieldType: Color, DefaultValue: #968918, Gradient Color 2.
#DesignerProperty: Key: PositionStyle, DisplayName: Position Style, FieldType: String, DefaultValue: none, Description: Position, List: absolute|fixed|none|relative|static|sticky
#DesignerProperty: Key: Position, DisplayName: Position Locations, FieldType: String, DefaultValue: t=?; b=?; r=?; l=?, Description: Position Locations
#DesignerProperty: Key: MarginAXYTBLR, DisplayName: Margins, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Margins A-X-Y-T-B-L-R
#DesignerProperty: Key: PaddingAXYTBLR, DisplayName: Paddings, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Paddings A-X-Y-T-B-L-R
#DesignerProperty: Key: RawClasses, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag.
#DesignerProperty: Key: RawStyles, DisplayName: Styles, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String- use =
#DesignerProperty: Key: RawAttributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String- use =
Private Sub Class_Globals
	Private mCallBack As Object 'ignore
	Private mEventName As String 'ignore
	Public UI As UIShared 'ignore
	Private sDeviceGridCols As String
	Private sGridCols As String
	Private bGrid As Boolean
	Public CustProps As Map
	Private sGap As String
	Private bFlex As Boolean
	Private bFlexCol As Boolean
	Public mElement As BANanoElement
	Private mName As String
	Private mTarget As BANanoElement
	Private BANano As BANano			'ignore
	Private bFullScreen As Boolean
	Public Tag As Object
'	Private sPageName As String
	Private sDescription As String
	Private sKeywords As String
	Private sTitle As String
	Private sBackgroundImage As String
	Private bFullPage As Boolean
	Private bResizePageView As Boolean
	Private sRawClasses As String = ""
	Private sRawStyles As String = ""
	Private sRawAttributes As String = ""
	Private sBackgroundColor As String = "base-100"
	Private sRounded As String = "none"
	Private sShadow As String = "none"
	Private sMarginAXYTBLR As String = "a=?; x=?; y=?; t=?; b=?; l=?; r=?"
	Private sPaddingAXYTBLR As String = "a=?; x=?; y=?; t=?; b=?; l=?; r=?"
	Private bHFull As Boolean
	Private bWFull As Boolean
	Private sHeight As String
	Private sWidth As String
	Private sMaxH As String
	Private sMaxW As String
	Private sMinH As String
	Private sMinW As String
	Private bContainer As Boolean
	Private bMxAuto As Boolean
	Private bFlexWrap As Boolean
	Private sParentID As String = "pageview"
	Private validations As Map
	Private sColumns As String
	Private bAsForm As Boolean
	Private sTextColor As String = ""
	Private bGlass As Boolean = False
	Private bVisible As Boolean = True
	Private sColor As String = "#000000"
	Private sIcon As String = "fa-solid fa-swatchbook"
	Private bClearParent As Boolean = False
	Private bActive As Boolean = True
	Private sPosition As String = "t=?; b=?; r=?; l=?"
	Private sPositionStyle As String = "none"
	Public Root As SDUI5Container
	Private bCenterChildren As Boolean
	Private bGradientActive As String
	Private sGradient As String
	Private sGradientColor1 As String
	Private sGradientColor2 As String
End Sub

Public Sub Initialize (CallBack As Object, Name As String, EventName As String)
	UI.Initialize(Me)
	mElement = Null
	mEventName = UI.CleanID(EventName)
	mName = UI.CleanID(Name)
	mCallBack = CallBack
	CustProps.Initialize
'	If mName <> "page" Then
'		BANano.Console.Warn($"Page.Initialize Error (${mName}) - the 'name' property should be 'page', use the 'Page Name' property to give the page a unique name."$)
'	End If
	SetDefaults
End Sub
'

private Sub SetDefaults
	CustProps.Put("ParentID", "pageview")
	CustProps.Put("ClearParent", False)
	CustProps.Put("Active", True)
	CustProps.Put("Title", "My SDUIPage")
	CustProps.Put("Icon", "fa-solid fa-swatchbook")
	CustProps.Put("Color", "#000000")
	CustProps.Put("RawDescription", "My SDUIPage")
	CustProps.Put("RawKeywords", "page")
	CustProps.Put("BackgroundImage", "")
	CustProps.Put("BackgroundColor", "base-100")
	CustProps.Put("FullPage", False)
	CustProps.Put("FullScreen", False)
	CustProps.Put("ResizePageView", True)
	CustProps.Put("Container", True)
	CustProps.Put("CenterChildren", False)
	CustProps.Put("MxAuto", True)
	CustProps.Put("Flex", True)
	CustProps.Put("FlexCol", False)
	CustProps.Put("Columns", "")
	CustProps.Put("FlexWrap", True)
	CustProps.Put("Gap", "")
	CustProps.Put("Grid", False)
	CustProps.Put("GridCols", "")
	CustProps.Put("DeviceGridCols", "xs=?; sm=?; md=?; lg=?; xl=?")
	CustProps.Put("Glass", False)
	CustProps.Put("TextColor", "")
	CustProps.Put("Width", "")
	CustProps.Put("MinW", "")
	CustProps.Put("MaxW", "")
	CustProps.Put("WFull", False)
	CustProps.Put("Height", "")
	CustProps.Put("MinH", "")
	CustProps.Put("MaxH", "")
	CustProps.Put("HFull", False)
	CustProps.Put("AsForm", False)
	CustProps.Put("Rounded", "none")
	CustProps.Put("Shadow", "none")
	CustProps.Put("Visible", True)
	CustProps.Put("GradientActive", False)
	CustProps.Put("Gradient", "")
	CustProps.Put("GradientColor1", "#f86194")
	CustProps.Put("GradientColor2", "#968918")
	CustProps.Put("PositionStyle", "none")
	CustProps.Put("Position", "t=?; b=?; r=?; l=?")
	CustProps.Put("MarginAXYTBLR", "a=?; x=?; y=?; t=?; b=?; l=?; r=?")
	CustProps.Put("PaddingAXYTBLR", "a=?; x=?; y=?; t=?; b=?; l=?; r=?")
	CustProps.Put("RawClasses", "")
	CustProps.Put("RawStyles", "")
	CustProps.Put("RawAttributes", "")
End Sub

' returns the element id
Public Sub getID() As String
	Return mName
End Sub

'set properties from an outside source
Sub SetProperties(props As Map)
	CustProps = BANano.DeepClone(props)
	sParentID = CustProps.Get("ParentID")
End Sub

Sub GetProperties As Map
	Return CustProps
End Sub

'add this element to an existing parent element using current props
Public Sub AddComponent
	If sParentID = "" Then Return
	sParentID = UI.CleanID(sParentID)
	mTarget = BANano.GetElement("#" & sParentID)
	DesignerCreateView(mTarget, CustProps)
End Sub

'remove this element from the dom
Public Sub Remove()
	mElement.Remove
	BANano.SetMeToNull
End Sub

'set the parent id
Sub setParentID(s As String)
	s = UI.CleanID(s)
	sParentID = s
	CustProps.Put("ParentID", sParentID)
End Sub

'get the parent id
Sub getParentID As String
	Return sParentID
End Sub

'return the #ID of the element
Public Sub getHere() As String
	Return $"#${mName}"$
End Sub

'set Visible
Sub setVisible(b As Boolean)
	bVisible = b
	CustProps.Put("Visible", b)
	If mElement = Null Then Return
	UI.SetVisible(mElement, b)
End Sub

'get Visible
Sub getVisible As Boolean
	bVisible = UI.GetVisible(mElement)
	Return bVisible
End Sub

'set Position Style
'options: static|relative|fixed|absolute|sticky|none
Sub setPositionStyle(s As String)
	sPositionStyle = s
	CustProps.put("PositionStyle", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetStyle(mElement, "position", s)
End Sub

Sub getPositionStyle As String
	Return sPositionStyle
End Sub

'set raw positions
Sub setPosition(s As String)
	sPosition = s
	CustProps.Put("Position", sPosition)
	If mElement = Null Then Return
	If s <> "" Then UI.SetPosition(mElement, sPosition)
End Sub

Sub getPosition As String
	Return sPosition
End Sub

Sub setAttributes(s As String)
	sRawAttributes = s
	CustProps.Put("RawAttributes", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetAttributes(mElement, sRawAttributes)
End Sub
'
Sub setStyles(s As String)
	sRawStyles = s
	CustProps.Put("RawStyles", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetStyles(mElement, sRawStyles)
End Sub
'
Sub setClasses(s As String)
	sRawClasses = s
	CustProps.put("RawClasses", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetClasses(mElement, sRawClasses)
End Sub
'
Sub setPaddingAXYTBLR(s As String)
	sPaddingAXYTBLR = s
	CustProps.Put("PaddingAXYTBLR", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetPaddingAXYTBLR(mElement, sPaddingAXYTBLR)
End Sub
'
Sub setMarginAXYTBLR(s As String)
	sMarginAXYTBLR = s
	CustProps.Put("MarginAXYTBLR", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetMarginAXYTBLR(mElement, sMarginAXYTBLR)
End Sub
'
Sub getAttributes As String
	Return sRawAttributes
End Sub
'
Sub getStyles As String
	Return sRawStyles
End Sub
'
Sub getClasses As String
	Return sRawClasses
End Sub
'
Sub getPaddingAXYTBLR As String
	Return sPaddingAXYTBLR
End Sub
'
Sub getMarginAXYTBLR As String
	Return sMarginAXYTBLR
End Sub


Private Sub DesignerCreateView (Target As BANanoElement, Props As Map)
	mTarget = Target
	If Props <> Null Then
		CustProps = Props
		UI.SetProps(Props)
		'UI.ExcludeBackgroundColor = True
		'UI.ExcludeTextColor = True
		'UI.ExcludeVisible = True
		'UI.ExcludeEnabled = True
		'sBackgroundColor = Props.GetDefault("BackgroundColor", "base-100")
		'sBackgroundColor = UI.CStr(sBackgroundColor)
		'If sBackgroundColor = "base-100" Then sBackgroundColor = ""
		sRounded = Props.GetDefault("Rounded", "none")
		sRounded = UI.CStr(sRounded)
		If sRounded = "none" Then sRounded = ""
		sShadow = Props.GetDefault("Shadow", "none")
		sShadow = UI.CStr(sShadow)
		If sShadow = "none" Then sShadow = ""		
'		sPageName = Props.GetDefault("PageName", "page1")
'		sPageName = UI.CleanID(sPageName)
		sDescription = Props.GetDefault("RawDescription", "")
		sDescription = UI.CStr(sDescription)
		sBackgroundImage = Props.GetDefault("BackgroundImage", "")
		sBackgroundImage = UI.CStr(sBackgroundImage)
		sKeywords = Props.GetDefault("RawKeywords", "")
		sKeywords = UI.CStr(sKeywords)
		sTitle = Props.GetDefault("Title", "")
		sTitle = UI.CStr(sTitle)
		bFullPage = Props.GetDefault("FullPage", False)
		bFullPage = UI.CBool(bFullPage)
		bFullScreen = Props.GetDefault("FullScreen", False)
		bFullScreen = UI.CBool(bFullScreen)
		bResizePageView = Props.GetDefault("ResizePageView", True)
		bResizePageView = UI.CBool(bResizePageView)
		bHFull = Props.GetDefault("HFull", False)
		bHFull = UI.CBool(bHFull)
		bWFull = Props.GetDefault("WFull", False)
		bWFull = UI.CBool(bWFull)
		sHeight = Props.GetDefault("Height", "")
		sHeight = UI.CStr(sHeight)
		sWidth = Props.GetDefault("Width", "")
		sWidth = UI.CStr(sWidth)
		sMaxH = Props.GetDefault("MaxH", "")
		sMaxH = UI.CStr(sMaxH)
		sMaxW = Props.GetDefault("MaxW", "")
		sMaxW = UI.CStr(sMaxW)
		sMinH = Props.GetDefault("MinH", "")
		sMinH = UI.CStr(sMinH)
		sMinW = Props.GetDefault("MinW", "")
		sMinW = UI.CStr(sMinW)
		bContainer = Props.GetDefault("Container", True)
		bContainer = UI.CBool(bContainer)
		bMxAuto = Props.GetDefault("MxAuto", True)
		bMxAuto = UI.CBool(bMxAuto)
		bFlex = Props.GetDefault("Flex", True)
		bFlex = UI.CBool(bFlex)
		bFlexCol = Props.GetDefault("FlexCol", False)
		bFlexCol = UI.CBool(bFlexCol)
		bFlexWrap = Props.GetDefault("FlexWrap", True)
		bFlexWrap = UI.CBool(bFlexWrap)
		sGap = Props.GetDefault("Gap", "")
		sGap = UI.CStr(sGap)
		sGridCols = Props.GetDefault("GridCols", "")
		sGridCols = UI.CStr(sGridCols)
		bGrid = Props.GetDefault("Grid", False)
		bGrid = UI.CBool(bGrid)
		sDeviceGridCols = Props.GetDefault("DeviceGridCols", "")
		sDeviceGridCols = UI.CStr(sDeviceGridCols)
		sColumns = Props.GetDefault("Columns", "")
		sColumns = UI.CStr(sColumns)
		bAsForm = Props.GetDefault("AsForm", False)
		bAsForm = UI.CBool(bAsForm)
		bGlass = Props.GetDefault("Glass", False)
		bGlass = UI.CBool(bGlass)
		sIcon = Props.GetDefault("Icon", "fa-solid fa-swatchbook")
		sIcon = UI.CStr(sIcon)
		sColor = Props.GetDefault("Color", "#000000")
		sColor = UI.CStr(sColor)
		bClearParent = Props.GetDefault("ClearParent", False)
		bClearParent = UI.CBool(bClearParent)
		bActive = Props.GetDefault("Active", True)
		bActive = UI.CBool(bActive)
		bCenterChildren = Props.GetDefault("CenterChildren", False)
		bCenterChildren = UI.CBool(bCenterChildren)
		bGradientActive = Props.GetDefault("GradientActive", False)
		bGradientActive = UI.CBool(bGradientActive)
		sGradient = Props.GetDefault("Gradient", "")
		sGradientColor1 = Props.GetDefault("GradientColor1", "#f86194")
		sGradientColor2 = Props.GetDefault("GradientColor2", "#968918")
	End If
	'
	'
	If bCenterChildren Then UI.AddCenterChildrenDT
	If sWidth <> "" Then UI.AddWidthDT(sWidth)
	If sHeight <> "" Then UI.AddHeightDT(sHeight)
	If bHFull Then UI.AddHeightDT("full")
	If bWFull Then UI.AddWidthDT("full")
	If sMaxH <> "" Then UI.AddMaxHeightDT(sMaxH)	
	If sMinH <> "" Then UI.AddMinHeightDT(sMinH)	
	If sMaxW <> "" Then UI.AddMaxWidthDT(sMaxW)
	If sMinW <> "" Then UI.AddMinWidthDT(sMinW)	
	If bGlass Then UI.AddClassDT("glass")
	If sRounded <> "" Then UI.AddRoundedDT(sRounded)
	If sShadow <> "" Then UI.AddShadowDT(sShadow)
	If sBackgroundImage <> "" Then UI.AddBackgroundImageDT(sBackgroundImage)
	If bFullPage Then 
		UI.AddHeightDT("full")
		UI.AddWidthDT("full")
	End If
	If bFullScreen Then
		UI.AddHeightDT("screen")
		UI.AddWidthDT("screen")
	End If
	If bContainer Then UI.AddClassDT("container")
	If bMxAuto Then UI.AddClassDT("mx-auto")
	If bFlex Then UI.AddClassDT("flex")
	If bFlexCol Then UI.AddClassDT("flex-col")
	If bFlexWrap Then UI.AddClassDT("flex-wrap")
	If sGap <> "" Then UI.AddClassDT($"gap-${sGap}"$)
	If bGrid Then UI.AddClassDT("grid")
	'
	Dim xattrs As String = UI.BuildExAttributes
	Dim xstyles As String = UI.BuildExStyle
	Dim xclasses As String = UI.BuildExClass
	'
	If sParentID <> "" Then
		'does the parent exist
		If BANano.Exists($"#${sParentID}"$) = False Then
			BANano.Throw($"${mName}.DesignerCreateView: '${sParentID}' parent does not exist!"$)
			Return
		End If
		mTarget.Initialize($"#${sParentID}"$)
	End If
	'if we need to clear the page, do it
	If bClearParent Then mTarget.Empty	
	Dim sTag As String = "div"
	If bAsForm Then sTag = "form"
	mElement = mTarget.Append($"[BANCLEAN]<${sTag} id="${mName}" class="${xclasses}" ${xattrs} style="${xstyles}"></${sTag}>"$).Get("#" & mName)
	'
	Root.Initialize(mCallBack, mName, mName)
	Root.linkexisting
	'
	setResizePageView(bResizePageView)
	setColumns(sColumns)
	setGridCols(sGridCols)
	setDeviceGridCols(sDeviceGridCols)
	If bGradientActive Then
		Dim agradient As String = UI.GetActualGradient(sGradient)
		UI.SetLinearGradient(mElement, agradient, sGradientColor1, sGradientColor2)
	End If
End Sub

Sub setCenterChildren(b As Boolean)
	bCenterChildren = b
	CustProps.Put("CenterChildren", b)
	If mElement = Null Then Return
	If b Then UI.SetCenterChildren(mElement, True)
End Sub

Sub getCenterChildren As Boolean
	Return bCenterChildren
End Sub

'clear the page
Sub Clear			'ignoredeadcode
	If mElement = Null Then Return
	mElement.empty
End Sub

Sub setActive(b As Boolean)
	bActive = b
	CustProps.Put("Active", b)
End Sub

Sub getActive As Boolean
	Return bActive
End Sub

Sub setIcon(s As String)
	sIcon = s
	CustProps.Put("Icon", s)
End Sub

Sub getIcon As String
	Return sIcon
End Sub

Sub setColor(s As String)
	sColor = s
	CustProps.put("Color", s)
End Sub

Sub getColor As String
	Return sColor
End Sub

Sub ClearPageView
	mTarget.Initialize("#pageview")
	mTarget.Empty
End Sub

'set Glass
Sub setGlass(b As Boolean)
	bGlass = b
	CustProps.put("Glass", b)
	If mElement = Null Then Return
	If b Then
		UI.AddClass(mElement, "glass")
	Else
		UI.RemoveClass(mElement, "glass")
	End If
End Sub

'set Background Color
Sub setBackgroundColor(s As String)
	sBackgroundColor = s
	CustProps.put("BackgroundColor", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetBackgroundColor(mElement, sBackgroundColor)
End Sub

'set Rounded
'options: none|rounded|2xl|3xl|full|lg|md|sm|xl|0
Sub setRounded(s As String)
	sRounded = s
	CustProps.put("Rounded", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetRounded(mElement, sRounded)
End Sub

'set Shadow
'options: shadow|sm|md|lg|xl|2xl|inner|none
Sub setShadow(s As String)
	sShadow = s
	CustProps.put("Shadow", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetShadow(mElement, sShadow)
End Sub

'get Background Color
Sub getBackgroundColor As String
	Return sBackgroundColor
End Sub

'get Rounded
Sub getRounded As String
	Return sRounded
End Sub

'get Shadow
Sub getShadow As String
	Return sShadow
End Sub


'set Text Color
Sub setTextColor(s As String)
	sTextColor = s
	CustProps.put("TextColor", s)
	UI.SetTextColor(mElement, sTextColor)
End Sub

'change columns
Sub setColumns(s As String)				'ignoredeadcode
	sColumns = s
	CustProps.Put("Columns", s)
	UI.SetColumns(mElement, s)
End Sub

Sub getColumns As String
	Return sColumns
End Sub

'change grid-cols
Sub setGridCols(s As String)				'ignoredeadcode
	CustProps.Put("GridCols", s)
	sGridCols = s
	If s = "" Then Return
	UI.SetGridCols(mElement, s)
End Sub

Sub getGridCols As String
	Return sGridCols
End Sub

'set Grid Cols Per Device
Sub setDeviceGridCols(s As String)			'ignoredeadcode
	CustProps.put("DeviceGridCols", s)
	s = UI.CStr(s)
	If s = "" Then Return
	If mElement = Null Then Return 
	Dim mx As Map = UI.GetDeviceSizes(s)
	For Each k As String In mx.Keys
		Dim v As String = mx.Get(k)
		If v <> "" Then
			UI.AddClass(mElement, $"${k}:grid-cols-${v}"$)
		End If
	Next
End Sub

Sub getDeviceGridCols As String
	Return sDeviceGridCols
End Sub

'w-full and h-full
Sub setFullPage(b As Boolean)
	bFullPage = b
	CustProps.put("FullPage", b)
	If b = False Then Return
	UI.SetWidth(mElement, "full")
	UI.SetHeight(mElement, "full")
End Sub

Sub getFullPage() As Boolean
	Return bFullPage
End Sub

Sub setResizePageView(b As Boolean)		'ignoredeadcode
	bResizePageView = b
	CustProps.put("ResizePageView", b)
	If b = False Then Return
	Dim pv As BANanoElement = BANano.GetElement($"#pageview"$)
	pv.AddClass("h-screen")
	pv.AddClass("w-screen")
	pv.AddClass("w-full")
	pv.AddClass("h-full")
End Sub

Sub getResizePageView() As Boolean
	Return bResizePageView
End Sub	

'w-screen and h-screen
Sub setFullScreen(b As Boolean)
	bFullScreen = b
	CustProps.put("FullScreen", b)
	If b = False Then Return
	UI.SetWidth(mElement, "screen")
	UI.SetHeight(mElement, "screen")
End Sub

Sub getFullScreen() As Boolean
	Return bFullScreen
End Sub

'Set Description
Sub setDescription(v As String)
	sDescription = UI.CStr(v)
	CustProps.put("RawDescription", sDescription)
End Sub

'Get Description
Sub getDescription As String
	Return sDescription
End Sub

'Sub getPageName As String
'	Return sPageName
'End Sub

'Set Keywords
Sub setKeywords(v As String)
	sKeywords = UI.CStr(v)
	CustProps.put("RawKeywords", sKeywords)
End Sub

'Get Keywords
Sub getKeywords As String
	Return sKeywords
End Sub

'Set Title
Sub setTitle(v As String)
	CustProps.put("Title", v)
	sTitle = UI.CStr(v)
End Sub

'Get Title
Sub getTitle As String
	Return sTitle
End Sub

'get the cell id
Sub CellID(r As Int, c As Int) As String
	Return Root.CellID(r, c)
End Sub

'get the cell id
Sub CellHere(r As Int, c As Int) As String
	Dim s As String = Root.CellID(r, c)
	Return $"#${s}"$
End Sub

'get the row/column div
Sub Cell(r As Int, c As Int) As SDUI5Container
	Return Root.Cell(r, c)
End Sub

'get the row div
Sub Row(r As Int) As SDUI5Container
	Return Root.Row(r)
End Sub

Sub setBackGroundImage(url As String)
	sBackgroundImage = UI.CStr(url)
	CustProps.put("BackgroundImage", url)
	UI.SetBackgroundImage(mElement, url)
End Sub

Sub getBackGroundImage As String
	Return	sBackgroundImage
End Sub

Sub BuildGrid
	Root.BuildGrid
End Sub

'add event
Sub On(event As String, CallBack As Object, MethodName As String)
	UI.OnEvent(mElement, event, CallBack, MethodName)
End Sub

'scroll to the top of the page
Sub ScrollToTop
	Dim so As Map = CreateMap("top": 0, "behavior": "smooth")
	BANano.GetElement(".drawer-content").RunMethod("scrollTo", so)
End Sub


'load a component from a json file
Sub LoadComponentJson(designName As String)
	CustProps = BANano.Await(BANano.GetFileAsJSON($"./assets/${designName}.json?${DateTime.Now}"$, Null))
End Sub

'reset the validations
'validate an element
'<code>
''reset the validations
'mdl.ResetValidation
''validate each of the elements
'mdl.Validate(txtFirstName.IsBlank)
'mdl.Validate(txtLastName.IsBlank)
'mdl.Validate(txtEmail.IsBlank)
'mdl.Validate(txtTelephone.IsBlank)
'mdl.Validate(txtAddress.IsBlank)
'mdl.Validate(radGender.IsBlank)
''check the form status
'If mdl.IsValid = False Then Return
'</code>
Sub ResetValidation
	validations.Initialize
End Sub
'<code>
'If txtEmail.IsBlank Then Return
'If txtpassword.IsBlank Then Return
'Dim record As Map = CreateMap()
'record.Put("email", txtEmail.Value)
'record.Put("password", txtpassword.Value)
'Log(record)
'</code>
Sub YesClickValidateEach
End Sub
'validate an element
'<code>
''reset the validations
'mdl.ResetValidation
''validate each of the elements
'mdl.Validate(txtFirstName.IsBlank)
'mdl.Validate(txtLastName.IsBlank)
'mdl.Validate(txtEmail.IsBlank)
'mdl.Validate(txtTelephone.IsBlank)
'mdl.Validate(txtAddress.IsBlank)
'mdl.Validate(radGender.IsBlank)
''check the form status
'If mdl.IsValid = False Then Return
'</code>
Sub YesClickValidateForm
End Sub
'validate an element
'<code>
''reset the validations
'mdl.ResetValidation
''validate each of the elements
'mdl.Validate(txtFirstName.IsBlank)
'mdl.Validate(txtLastName.IsBlank)
'mdl.Validate(txtEmail.IsBlank)
'mdl.Validate(txtTelephone.IsBlank)
'mdl.Validate(txtAddress.IsBlank)
'mdl.Validate(radGender.IsBlank)
''check the form status
'If mdl.IsValid = False Then Return
'</code>
Sub Validate(response As Boolean)
	'add responses that are true
	validations.Put(response, response)
End Sub
'get the validation
'validate an element
'<code>
''reset the validations
'mdl.ResetValidation
''validate each of the elements
'mdl.Validate(txtFirstName.IsBlank)
'mdl.Validate(txtLastName.IsBlank)
'mdl.Validate(txtEmail.IsBlank)
'mdl.Validate(txtTelephone.IsBlank)
'mdl.Validate(txtAddress.IsBlank)
'mdl.Validate(radGender.IsBlank)
''check the form status
'If mdl.IsValid = False Then Return
'</code>
Sub IsValid As Boolean
	Dim hastrue As Boolean = validations.ContainsKey(True)
	If hastrue Then Return False
	Return True
End Sub

Sub LinkExisting(xPage As String)
	mName = xPage
	CustProps.put("PageName", mName)
	mElement.Initialize($"#${mName}"$)
	Root.Initialize(mCallBack, mName, mName)
	Root.LinkExisting
End Sub
''
''set Page Name*
'Sub setPageName(s As String)
'	sPageName = UI.CStr(s)
'	sPageName = UI.CleanID(sPageName)
'	mName = sPageName
'	CustProps.put("PageName", s)
'End Sub

'set Container
Sub setContainer(b As Boolean)
	bContainer = UI.CBool(b)
	CustProps.put("Container", b)
	If b Then 
		UI.AddClass(mElement, "container")
	Else
		UI.RemoveClass(mElement, "container")	
	End If
End Sub
'
'set Mx Auto
Sub setMxAuto(b As Boolean)
	bMxAuto = UI.CBool(b)
	CustProps.put("MxAuto", b)
	If b Then
		UI.AddClass(mElement, "mx-auto")
	Else
		UI.RemoveClass(mElement, "mx-auto")
	End If
End Sub
'
'set Flex
Sub setFlex(b As Boolean)
	bFlex = UI.CBool(b)
	CustProps.put("Flex", b)
	If mElement = Null Then Return
	If b Then
		UI.AddClass(mElement, "flex")
	Else
		UI.RemoveClass(mElement, "flex")
	End If
End Sub
'
'set Flex Col
Sub setFlexCol(b As Boolean)
	bFlexCol = UI.CBool(b)
	CustProps.put("FlexCol", b)
	If b Then
		UI.AddClass(mElement, "flex-col")
	Else
		UI.RemoveClass(mElement, "flex-col")
	End If
End Sub
'
'set Flex Wrap
Sub setFlexWrap(b As Boolean)
	bFlexWrap = UI.CBool(b)
	CustProps.put("FlexWrap", b)
	If b Then
		UI.AddClass(mElement, "flex-wrap")
	Else
		UI.RemoveClass(mElement, "flex-wrap")
	End If
End Sub
'
'set Gap
Sub setGap(s As String)
	sGap = UI.CStr(s)
	CustProps.put("Gap", s)
	UI.SetGap(mElement, s)
End Sub
'
'set Grid
Sub setGrid(b As Boolean)
	bGrid = UI.CBool(b)
	CustProps.put("Grid", b)
	If b Then
		UI.AddClass(mElement, "grid")
	Else
		UI.RemoveClass(mElement, "grid")
	End If
End Sub
'
'set Width
Sub setWidth(s As String)
	sWidth = UI.CStr(s)
	CustProps.put("W", s)
	UI.SetWidth(mElement, s)
End Sub
'
'set Min Width
Sub setMinW(s As String)
	sMinW = UI.CStr(s)
	CustProps.put("MinW", s)
	UI.SetSize(mElement, "minw", "min-w", s)
End Sub
'
'set Max Width
Sub setMaxW(s As String)
	sMaxW = UI.CStr(s)
	CustProps.put("MaxW", s)
	UI.SetSize(mElement, "maxw", "max-w", s)
End Sub
'
'set W Full
Sub setWFull(b As Boolean)
	bWFull = UI.CBool(b)
	CustProps.put("WFull", b)
	If b Then
		UI.AddClass(mElement, "w-full")
	Else
		UI.RemoveClass(mElement, "w-full")
	End If
End Sub
'
'set Height
Sub setHeight(s As String)
	sHeight = UI.CStr(s)
	CustProps.put("H", s)
	UI.SetWidth(mElement, s)
End Sub
'
'set Min Height
Sub setMinH(s As String)
	sMinH = UI.CStr(s)
	CustProps.put("MinH", s)
	UI.SetSize(mElement, "minh", "min-h", s)
End Sub
'
'set Max Height
Sub setMaxH(s As String)
	sMaxH = UI.CStr(s)
	CustProps.put("MaxH", s)
	UI.SetSize(mElement, "maxh", "max-h", s)
End Sub
'
'set H Full
Sub setHFull(b As Boolean)
	bHFull = UI.CBool(b)
	CustProps.put("HFull", b)
	If b Then
		UI.AddClass(mElement, "h-full")
	Else
		UI.RemoveClass(mElement, "h-full")
	End If
End Sub
'
'set AsForm
Sub setAsForm(b As Boolean)
	bAsForm = UI.CBool(b)
	CustProps.put("AsForm", b)
End Sub


'get Container
Sub getContainer As Boolean
	Return bContainer
End Sub
'
'get Mx Auto
Sub getMxAuto As Boolean
	Return bMxAuto
End Sub
'
'get Flex
Sub getFlex As Boolean
	Return bFlex
End Sub
'
'get Flex Col
Sub getFlexCol As Boolean
	Return bFlexCol
End Sub
'
'get Flex Wrap
Sub getFlexWrap As Boolean
	Return bFlexWrap
End Sub
'
'get Gap
Sub getGap As String
	Return sGap
End Sub
'
'get Grid
Sub getGrid As Boolean
	Return bGrid
End Sub
'

'get Glass
Sub getGlass As Boolean
	Return bGlass
End Sub

'get Text Color
Sub getTextColor As String
	Return sTextColor
End Sub
'
'get Width
Sub getWidth As String
	Return sWidth
End Sub
'
'get Min Width
Sub getMinW As String
	Return sMinW
End Sub
'
'get Max Width
Sub getMaxW As String
	Return sMaxW
End Sub
'
'get W Full
Sub getWFull As Boolean
	Return bWFull
End Sub
'
'get Height
Sub getHeight As String
	Return sHeight
End Sub
'
'get Min Height
Sub getMinH As String
	Return sMinH
End Sub
'
'get Max Height
Sub getMaxH As String
	Return sMaxH
End Sub
'
'get H Full
Sub getHFull As Boolean
	Return bHFull
End Sub
'
'get AsForm
Sub getAsForm As Boolean
	Return bAsForm
End Sub
'
'set Clear Parent
Sub setClearParent(b As Boolean)
	bClearParent = UI.CBool(b)
	CustProps.put("ClearParent", b)
End Sub
'
'get Clear Parent
Sub getClearParent As Boolean
	Return bClearParent
End Sub