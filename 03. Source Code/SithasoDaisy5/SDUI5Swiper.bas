B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=10
@EndOfDesignText@
#IgnoreWarnings:12
'https://github.com/ionic-team/ionic-framework/blob/main/core/src/components/slides/IonicSlides.ts
'#Event: ActiveIndexChange (e As BANanoEvent)
'#Event: ChangeDirection (e As BANanoEvent)
'#Event: Click (e As BANanoEvent)
'#Event: DoubleClick (e As BANanoEvent)
'#Event: DoubleTap (e As BANanoEvent)
'#Event: Orientationchange (e As BANanoEvent)
'#Event: Progress (e As BANanoEvent)
'#Event: ReachBeginning (e As BANanoEvent)
'#Event: ReachEnd (e As BANanoEvent)
'#Event: Resize (e As BANanoEvent)
'#Event: SlideChange (e As BANanoEvent)
'#Event: SliderMove (e As BANanoEvent)
'#Event: Tap (e As BANanoEvent)
#DesignerProperty: Key: ReadMe, DisplayName: ReadMe Children, FieldType: String, DefaultValue: _slides|_pagination|_prev|_next|_scrollbar, Description: _slides|_pagination|_prev|_next|_scrollbar
#DesignerProperty: Key: ParentID, DisplayName: ParentID, FieldType: String, DefaultValue: , Description: The ParentID of this component
#DesignerProperty: Key: Parallax, DisplayName: Parallax, FieldType: Boolean, DefaultValue: False, Description: Parallax
#DesignerProperty: Key: PaginationType, DisplayName: Pagination Type, FieldType: String, DefaultValue: bullets, Description: Pagination Type, List: bullets|fraction|progressbar
#DesignerProperty: Key: SlidesPerView, DisplayName: Slides Per View, FieldType: String, DefaultValue: 1, Description: Slides Per View
#DesignerProperty: Key: SpaceBetween, DisplayName: Space Between, FieldType: String, DefaultValue: 0, Description: Space Between
#DesignerProperty: Key: CenteredSlides, DisplayName: Centered Slides, FieldType: Boolean, DefaultValue: False, Description: Centered Slides
#DesignerProperty: Key: Direction, DisplayName: Direction, FieldType: String, DefaultValue: horizontal, Description: Direction, List: horizontal|vertical
#DesignerProperty: Key: Effect, DisplayName: Effect, FieldType: String, DefaultValue: slide, Description: Effect, List: slide|fade|cube|coverflow|flip|creative|cards
#DesignerProperty: Key: CssMode, DisplayName: CssMode, FieldType: Boolean, DefaultValue: False, Description: CssMode
#DesignerProperty: Key: KeyboardEnabled, DisplayName: Keyboard Enabled, FieldType: Boolean, DefaultValue: True, Description: Keyboard Enabled
#DesignerProperty: Key: MouseWheel, DisplayName: Mouse Wheel, FieldType: Boolean, DefaultValue: False, Description: Mouse Wheel
#DesignerProperty: Key: HasNavigation, DisplayName: Has Navigation, FieldType: Boolean, DefaultValue: False, Description: Has Navigation
#DesignerProperty: Key: OwnNavigation, DisplayName: Own Navigation, FieldType: Boolean, DefaultValue: False, Description: Own Navigation
#DesignerProperty: Key: NextNavigation, DisplayName: Next Navigation, FieldType: String, DefaultValue: , Description: Next Navigation
#DesignerProperty: Key: PrevNavigation, DisplayName: Prev Navigation, FieldType: String, DefaultValue: , Description: Prev Navigation
#DesignerProperty: Key: HasPagination, DisplayName: Has Pagination, FieldType: Boolean, DefaultValue: True, Description: Has Pagination
#DesignerProperty: Key: HasScrollbar, DisplayName: Has Scrollbar, FieldType: Boolean, DefaultValue: False, Description: Has Scrollbar
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: 300px, Description: Height
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: 100%, Description: Width
#DesignerProperty: Key: Speed, DisplayName: Speed, FieldType: String, DefaultValue: 300, Description: Speed
#DesignerProperty: Key: Init, DisplayName: Init, FieldType: Boolean, DefaultValue: True, Description: Init
#DesignerProperty: Key: InitialSlide, DisplayName: Initial Slide, FieldType: String, DefaultValue: 0, Description: Initial Slide
#DesignerProperty: Key: TotalSlides, DisplayName: Total Slides, FieldType: String, DefaultValue: , Description: Total Slides to add
#DesignerProperty: Key: Loops, DisplayName: Loops, FieldType: Boolean, DefaultValue: False, Description: Loops
#DesignerProperty: Key: DynamicBullets, DisplayName: DynamicBullets, FieldType: Boolean, DefaultValue: False, Description: Dynamic Bullets
#DesignerProperty: Key: UpdateOnWindowResize, DisplayName: Update On Window Resize, FieldType: Boolean, DefaultValue: True, Description: Update On Window Resize
#DesignerProperty: Key: AutoPlay, DisplayName: Auto Play, FieldType: Boolean, DefaultValue: False, Description: Auto Play
#DesignerProperty: Key: AutoPlayDelay, DisplayName: Auto Play Delay, FieldType: Int, DefaultValue: 3000, Description: Auto Play Delay
#DesignerProperty: Key: AutoPlayDisableOnInteraction, DisplayName: Auto Play Disable On Interaction, FieldType: Boolean, DefaultValue: True, Description: Auto Play Disable On Interaction
#DesignerProperty: Key: AutoPlayPauseOnMouseEnter, DisplayName: Auto Play Pause On Mouse Enter, FieldType: Boolean, DefaultValue: False, Description: Auto Play Pause On Mouse Enter
#DesignerProperty: Key: AutoPlayReverseDirection, DisplayName: Auto Play Reverse Direction, FieldType: Boolean, DefaultValue: False, Description: Auto Play Reverse Direction
#DesignerProperty: Key: AutoPlayStopOnLastSlide, DisplayName: Auto Play Stop On Last Slide, FieldType: Boolean, DefaultValue: False, Description: Auto Play Stop On Last Slide
#DesignerProperty: Key: AutoPlayWaitForTransition, DisplayName: Auto Play Wait For Transition, FieldType: Boolean, DefaultValue: True, Description: Auto Play Wait For Transition
#DesignerProperty: Key: Grid, DisplayName: Grid, FieldType: Boolean, DefaultValue: False, Description: Grid
#DesignerProperty: Key: GridFill, DisplayName: Grid Fill, FieldType: String, DefaultValue: column, Description: Grid Fill, List: column|row
#DesignerProperty: Key: GridRows, DisplayName: Grid Rows, FieldType: Int, DefaultValue: 1, Description: Grid Rows
#DesignerProperty: Key: CardEffectPerSlideOffset, DisplayName: Card Effect Per Slide Offset, FieldType: Int, DefaultValue: 8, Description: Card Effect Per Slide Offset
#DesignerProperty: Key: CardEffectPerSlideRotate, DisplayName: Card Effect Per Slide Rotate, FieldType: Int, DefaultValue: 2, Description: Card Effect Per Slide Rotate
#DesignerProperty: Key: CardEffectRotate, DisplayName: Card Effect Rotate, FieldType: Boolean, DefaultValue: True, Description: Card Effect Rotate
#DesignerProperty: Key: CardEffectSlideShadows, DisplayName: Card Effect Slide Shadows, FieldType: Boolean, DefaultValue: True, Description: Card Effect Slide Shadows
#DesignerProperty: Key: CoverFlowDepth, DisplayName: Cover Flow Depth, FieldType: Int, DefaultValue: 100, Description: Cover Flow Depth
#DesignerProperty: Key: CoverFlowModifier, DisplayName: Cover Flow Modifier, FieldType: Int, DefaultValue: 1, Description: Cover Flow Modifier
#DesignerProperty: Key: CoverFlowRotate, DisplayName: Cover Flow Rotate, FieldType: Int, DefaultValue: 50, Description: Cover Flow Rotate
#DesignerProperty: Key: CoverFlowScale, DisplayName: Cover Flow Scale, FieldType: Int, DefaultValue: 1, Description: Cover Flow Scale
#DesignerProperty: Key: CoverFlowSlideShadows, DisplayName: Cover Flow Slide Shadows, FieldType: Boolean, DefaultValue: True, Description: Cover Flow Slide Shadows
#DesignerProperty: Key: CoverFlowStretch, DisplayName: Cover Flow Stretch, FieldType: Int, DefaultValue: 0, Description: Cover Flow Stretch
#DesignerProperty: Key: CubeEffectShadow, DisplayName: Cube Effect Shadow, FieldType: Boolean, DefaultValue: True, Description: Cube Effect Shadow
#DesignerProperty: Key: CubeEffectShadowOffset, DisplayName: Cube Effect Shadow Offset, FieldType: Int, DefaultValue: 20, Description: Cube Effect Shadow Offset
#DesignerProperty: Key: CubeEffectShadowScale, DisplayName: Cube Effect Shadow Scale, FieldType: String, DefaultValue: 0.94, Description: Cube Effect Shadow Scale
#DesignerProperty: Key: CubeEffectSlideShadows, DisplayName: Cube Effect Slide Shadows, FieldType: Boolean, DefaultValue: True, Description: Cube Effect Slide Shadows
#DesignerProperty: Key: RawSlideImageStyle, DisplayName: Slide Image Style, FieldType: String, DefaultValue: width=auto;max-width=100%;height=auto;max-height=100%;object-fit=cover, Description: Raw Slide Image Style
#DesignerProperty: Key: RawSlideStyle, DisplayName: Slide Style, FieldType: String, DefaultValue: display=flex;position=relative;flex-direction=column;flex-shrink=0;align-items=center;justify-content=center;width=100%;height=100%;font-size=18px;text-align=center;box-sizing=border-box, Description: Raw Slide Style
#DesignerProperty: Key: Rounded, DisplayName: Rounded, FieldType: String, DefaultValue: none, Description: Rounded, List: 0|2xl|3xl|full|lg|md|none|rounded|sm|xl
#DesignerProperty: Key: Shadow, DisplayName: Shadow, FieldType: String, DefaultValue: none, Description: Shadow, List: 2xl|inner|lg|md|none|shadow|sm|xl
#DesignerProperty: Key: Visible, DisplayName: Visible, FieldType: Boolean, DefaultValue: True, Description: If visible.
#DesignerProperty: Key: PaddingAXYTBLR, DisplayName: Paddings, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Paddings A(all)-X(LR)-Y(TB)-T-B-L-R
#DesignerProperty: Key: MarginAXYTBLR, DisplayName: Margins, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Margins A(all)-X(LR)-Y(TB)-T-B-L-R
#DesignerProperty: Key: RawClasses, DisplayName: Classes (;), FieldType: String, DefaultValue: , Description: Classes added to the HTML tag.
#DesignerProperty: Key: RawStyles, DisplayName: Styles (JSON), FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String use = and ;
#DesignerProperty: Key: RawAttributes, DisplayName: Attributes (JSON), FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String use = and ;
Sub Class_Globals
	Public UI As UIShared 'ignore
    Public CustProps As Map 'ignore
    Private mCallBack As Object 'ignore
    Private mEventName As String 'ignore
    Public mElement As BANanoElement 'ignore
    Private mTarget As BANanoElement 'ignore
    Private mName As String 'ignore
    Private BANano As BANano   'ignore
    Private bVisible As Boolean = True
    Public Tag As Object
    Public Options As Map
    Private bCenteredSlides As Boolean = False
    Private sDirection As String = "horizontal"
    Private sEffect As String = "slide"
    Private bHasNavigation As Boolean = False
    Private bHasPagination As Boolean = True
    Private bHasScrollbar As Boolean = False
    Private sHeight As String = "300px"
    Private bInit As Boolean = True
    Private sInitialSlide As String = "0"
    Private bLoops As Boolean = False
    Private sSpaceBetween As String = "0"
    Private sSpeed As String = "300"
    Private sWidth As String = "100%"
    Private bDynamicBullets As Boolean = False
    Public CONST DIRECTION_HORIZONTAL As String = "horizontal"
    Public CONST DIRECTION_VERTICAL As String = "vertical"
    Public CONST EFFECT_COVERFLOW As String = "coverflow"
    Public CONST EFFECT_CREATIVE As String = "creative"
    Public CONST EFFECT_CUBE As String = "cube"
    Public CONST EFFECT_FADE As String = "fade"
    Public CONST EFFECT_FLIP As String = "flip"
    Public CONST EFFECT_SLIDE As String = "slide"
    Private sPaginationType As String = "bullets"
    Private sSlidesPerView As String = "1"
    Public CONST PAGINATIONTYPE_BULLETS As String = "bullets"
    Public CONST PAGINATIONTYPE_FRACTION As String = "fraction"
    Public CONST PAGINATIONTYPE_PROGRESSBAR As String = "progressbar"
    Private bParallax As Boolean = False
    Private swiper As BANanoObject
    Private bUpdateOnWindowResize As Boolean
    Private items As List
    Private sTotalSlides As String
    Private sParentID As String
    Public Children As Map
    Private bAutoPlay As Boolean = False
    Private iAutoPlayDelay As Int = 3000
    Private bAutoPlayDisableOnInteraction As Boolean = True
    Private bAutoPlayPauseOnMouseEnter As Boolean = False
    Private bAutoPlayReverseDirection As Boolean = False
    Private bAutoPlayStopOnLastSlide As Boolean = False
    Private bAutoPlayWaitForTransition As Boolean = True
    Private bGrid As Boolean = False
    Private sGridFill As String = "column"
    Private iGridRows As Int = 1
    Public CONST GRIDFILL_COLUMN As String = "column"
    Public CONST GRIDFILL_ROW As String = "row"
    Private sPaddingAXYTBLR As String
    Private sMarginAXYTBLR As String
    Private sRawClasses As String
    Private sRawStyles As String
    Private sRawAttributes As String
    Private iCardEffectPerSlideOffset As Int = 8
    Private iCardEffectPerSlideRotate As Int = 2
    Private bCardEffectRotate As Boolean = True
    Private bCardEffectSlideShadows As Boolean = True
    Private iCoverFlowDepth As Int = 100
    Private iCoverFlowModifier As Int = 1
    Private iCoverFlowRotate As Int = 50
    Private iCoverFlowScale As Int = 1
    Private bCoverFlowSlideShadows As Boolean = True
    Private iCoverFlowStretch As Int = 0
    Private bCubeEffectShadow As Boolean = True
    Private iCubeEffectShadowOffset As Int = 20
    Private dCubeEffectShadowScale As Double = 0.94
    Private bCubeEffectSlideShadows As Boolean = True
	Private sRawSlideImageStyle As String = "width=auto;max-width=100%;height=auto;max-height=100%;object-fit=cover"
	Private sRawSlideStyle As String = "display=flex;position=relative;flex-direction=column;flex-shrink=0;align-items=center;justify-content=center;width=100%;height=100%;font-size=18px;text-align=center;box-sizing=border-box"
	Private sRounded As String = "none"
	Private sShadow As String = "none"
	Private bCssMode As Boolean = False
	Private bKeyboardEnabled As Boolean = False
	Private bMouseWheel As Boolean = False
	Private sNextNavigation As String = ""
	Private bOwnNavigation As Boolean = False
	Private sPrevNavigation As String = ""
End Sub
'#if css
'.swiper {
'--swiper-pagination-bullet-inactive-color: var(--ion-color-step-200, #cccccc);
'--swiper-pagination-color: var(--ion-color-primary, #3880ff);
'--swiper-pagination-progressbar-bg-color: rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.25);
'--swiper-scrollbar-bg-color: rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1);
'--swiper-scrollbar-drag-bg-color: rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.5);
'}
'.swiper-slide {
'display: flex;
'position: relative;
'flex-direction: column;
'flex-shrink: 0;
'align-items: center;
'justify-content: center;
'width: 100%;
'height: 100%;
'font-size: 18px;
'text-align: center;
'box-sizing: border-box;
'}
'.swiper-slide img {
'width: auto;
'max-width: 100%;
'height: auto;
'max-height: 100%;
'object-fit: cover;
'}
'#End If
'
'#if css
'.swiper-button-disabled {
'    opacity: 0.5;
'    pointer-events: none;
'    cursor: not-allowed;
'}
'#End If

Public Sub Initialize (Callback As Object, Name As String, EventName As String)
	If BANano.AssetsIsDefined("Swiper") = False Then
		BANano.Throw($"Uses Error: 'BANano.Await(app.UsesSwiper)' should be added!"$)
		Return
	End If
	BANano.DependsOnAsset("swiper-bundle.min.js")
	BANano.DependsOnAsset("swiper-bundle.min.css")
	UI.Initialize(Me)
    mEventName = UI.CleanID(EventName)
    mName = UI.CleanID(Name)
    mCallBack = Callback
    CustProps.Initialize
    Options.Initialize
    items.Initialize
	Children.Initialize
	SetDefaults
End Sub

Private Sub SetDefaults
	CustProps.Put("ParentID", "")
	CustProps.Put("Parallax", False)
	CustProps.Put("PaginationType", "bullets")
	CustProps.Put("SlidesPerView", "1")
	CustProps.Put("SpaceBetween", "0")
	CustProps.Put("CenteredSlides", False)
	CustProps.Put("Direction", "horizontal")
	CustProps.Put("Effect", "slide")
	CustProps.Put("HasNavigation", False)
	CustProps.Put("HasPagination", True)
	CustProps.Put("HasScrollbar", False)
	CustProps.Put("Height", "300px")
	CustProps.Put("CssMode", False)
	CustProps.Put("Width", "100%")
	CustProps.Put("Speed", "300")
	CustProps.Put("Init", True)
	CustProps.Put("InitialSlide", "0")
	CustProps.Put("TotalSlides", "")
	CustProps.Put("Loops", False)
	CustProps.Put("DynamicBullets", False)
	CustProps.Put("UpdateOnWindowResize", True)
	CustProps.Put("AutoPlay", False)
	CustProps.Put("AutoPlayDelay", 3000)
	CustProps.Put("AutoPlayDisableOnInteraction", True)
	CustProps.Put("AutoPlayPauseOnMouseEnter", False)
	CustProps.Put("AutoPlayReverseDirection", False)
	CustProps.Put("AutoPlayStopOnLastSlide", False)
	CustProps.Put("AutoPlayWaitForTransition", True)
	CustProps.Put("Grid", False)
	CustProps.Put("GridFill", "column")
	CustProps.Put("GridRows", 1)
	CustProps.Put("CardEffectPerSlideOffset", 8)
	CustProps.Put("CardEffectPerSlideRotate", 2)
	CustProps.Put("CardEffectRotate", True)
	CustProps.Put("CardEffectSlideShadows", True)
	CustProps.Put("CoverFlowDepth", 100)
	CustProps.Put("CoverFlowModifier", 1)
	CustProps.Put("CoverFlowRotate", 50)
	CustProps.Put("CoverFlowScale", 1)
	CustProps.Put("CoverFlowSlideShadows", True)
	CustProps.Put("CoverFlowStretch", 0)
	CustProps.Put("CubeEffectShadow", True)
	CustProps.Put("CubeEffectShadowOffset", 20)
	CustProps.Put("CubeEffectShadowScale", "0.94")
	CustProps.Put("CubeEffectSlideShadows", True)
	CustProps.Put("RawSlideImageStyle", "width=auto;max-width=100%;height=auto;max-height=100%;object-fit=cover")
	CustProps.Put("RawSlideStyle", "display=flex;position=relative;flex-direction=column;flex-shrink=0;align-items=center;justify-content=center;width=100%;height=100%;font-size=18px;text-align=center;box-sizing=border-box")
	CustProps.Put("Visible", True)
	CustProps.Put("PaddingAXYTBLR", "a=?; x=?; y=?; t=?; b=?; l=?; r=? ")
	CustProps.Put("MarginAXYTBLR", "a=?; x=?; y=?; t=?; b=?; l=?; r=? ")
	CustProps.Put("RawClasses", "")
	CustProps.Put("RawStyles", "")
	CustProps.Put("RawAttributes", "")
	CustProps.Put("Rounded", "none")                 
	CustProps.Put("Shadow", "none")
	CustProps.Put("KeyboardEnabled", False)
	CustProps.Put("MouseWheel", False)
	CustProps.Put("NextNavigation", "")
	CustProps.Put("OwnNavigation", False)
	CustProps.Put("PrevNavigation", "")
End Sub

Sub setMouseWheel(b As Boolean)
	bMouseWheel = b
	CustProps.Put("MouseWheel", bMouseWheel)
End Sub

Sub getMouseWheel As Boolean
	Return bMouseWheel
End Sub

Sub setCssMode(b As Boolean)
	bCssMode = b
	CustProps.Put("CssMode", bCssMode)
End Sub

Sub getCssMode As Boolean
	Return bCssMode
End Sub

Sub setAttributes(s As String)
	sRawAttributes = s
	CustProps.Put("RawAttributes", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetAttributes(mElement, sRawAttributes)
End Sub
'
Sub setStyles(s As String)
	sRawStyles = s
	CustProps.Put("RawStyles", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetStyles(mElement, sRawStyles)
End Sub
'
Sub setClasses(s As String)
	sRawClasses = s
	CustProps.put("RawClasses", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetClasses(mElement, sRawClasses)
End Sub

'
Sub setPaddingAXYTBLR(s As String)
	sPaddingAXYTBLR = s
	CustProps.Put("PaddingAXYTBLR", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetPaddingAXYTBLR(mElement, sPaddingAXYTBLR)
End Sub
'
Sub setMarginAXYTBLR(s As String)
	sMarginAXYTBLR = s
	CustProps.Put("MarginAXYTBLR", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetMarginAXYTBLR(mElement, sMarginAXYTBLR)
End Sub
'
Sub getAttributes As String
	Return sRawAttributes
End Sub
'
Sub getStyles As String
	Return sRawStyles
End Sub
'
Sub getClasses As String
	Return sRawClasses
End Sub
'
Sub getPaddingAXYTBLR As String
	Return sPaddingAXYTBLR
End Sub
'
Sub getMarginAXYTBLR As String
	Return sMarginAXYTBLR
End Sub

'set Rounded
'options: none|rounded|2xl|3xl|full|lg|md|sm|xl|0
Sub setRounded(s As String)
	sRounded = s
	CustProps.put("Rounded", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetRounded(mElement, sRounded)
End Sub
'set Shadow
'options: shadow|sm|md|lg|xl|2xl|inner|none
Sub setShadow(s As String)
	sShadow = s
	CustProps.put("Shadow", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetShadow(mElement, sShadow)
End Sub

'get Rounded
Sub getRounded As String
	Return sRounded
End Sub
'get Shadow
Sub getShadow As String
	Return sShadow
End Sub

'set Visible
Sub setVisible(b As Boolean)
	bVisible = b
	CustProps.Put("Visible", b)
	If mElement = Null Then Return
	UI.SetVisible(mElement, b)
End Sub
'get Visible
Sub getVisible As Boolean
	bVisible = UI.GetVisible(mElement)
	Return bVisible
End Sub

'add this element to an existing parent element using current props
Public Sub AddComponent
	If sParentID = "" Then Return
	sParentID = UI.CleanID(sParentID)
	mTarget = BANano.GetElement("#" & sParentID)
	DesignerCreateView(mTarget, CustProps)
End Sub

'set properties from an outside source
Sub SetProperties(props As Map)
	CustProps = BANano.DeepClone(props)
	sParentID = CustProps.Get("ParentID")
End Sub

Sub GetProperties As Map
	Return CustProps
End Sub

' returns the BANanoElement
Public Sub getElement() As BANanoElement
    Return mElement
End Sub
' returns the element id
Public Sub getID() As String
    Return mName
End Sub


'load a component from a json file
Sub LoadComponentJson(designName As String)
	CustProps = BANano.Await(BANano.GetFileAsJSON($"./assets/${designName}.json?${DateTime.Now}"$, Null))
End Sub

Public Sub Remove()
    mElement.Remove
    BANano.SetMeToNull
End Sub

Sub setElement(e As BANanoElement)
    mElement = e
End Sub

Sub Clear					'ignoredeadcode
    items.Initialize
    If mElement <> Null Then
        BANano.GetElement($"#${mName}_slides"$).Empty
    End If
End Sub


Public Sub getHere() As String
    Return $"#${mName}"$
End Sub
Public Sub getSlidesHere() As String
    Return $"#${mName}_slides"$
End Sub

'
Public Sub DesignerCreateView (Target As BANanoElement, Props As Map)
    mTarget = Target
    If Props <> Null Then
        CustProps = Props
		UI.SetProps(Props)
        bVisible = Props.GetDefault("Visible", True)
        bVisible = UI.CBool(bVisible)
        bCenteredSlides = Props.GetDefault("CenteredSlides", False)
        bCenteredSlides = UI.CBool(bCenteredSlides)
        sDirection = Props.GetDefault("Direction", "horizontal")
        sDirection = UI.CStr(sDirection)
        sEffect = Props.GetDefault("Effect", "slide")
        sEffect = UI.CStr(sEffect)
        bHasNavigation = Props.GetDefault("HasNavigation", False)
        bHasNavigation = UI.CBool(bHasNavigation)
        bHasPagination = Props.GetDefault("HasPagination", True)
        bHasPagination = UI.CBool(bHasPagination)
        bHasScrollbar = Props.GetDefault("HasScrollbar", False)
        bHasScrollbar = UI.CBool(bHasScrollbar)
        sHeight = Props.GetDefault("Height", "300px")
        sHeight = UI.CStr(sHeight)
        bInit = Props.GetDefault("Init", True)
        bInit = UI.CBool(bInit)
        sInitialSlide = Props.GetDefault("InitialSlide", "0")
        sInitialSlide = UI.CStr(sInitialSlide)
        bLoops = Props.GetDefault("Loops", False)
        bLoops = UI.CBool(bLoops)
        sWidth = Props.GetDefault("Width", "100%")
        sWidth = UI.CStr(sWidth)
        sSpeed = Props.GetDefault("Speed", "300")
        sSpeed = UI.CInt(sSpeed)
        bDynamicBullets = Props.GetDefault("DynamicBullets", False)
        bDynamicBullets = UI.CBool(bDynamicBullets)
        sPaginationType = Props.GetDefault("PaginationType", "bullets")
        sPaginationType = UI.CStr(sPaginationType)
        sSlidesPerView = Props.GetDefault("SlidesPerView", "1")
        sSlidesPerView = UI.CStr(sSlidesPerView)
        sSpaceBetween = Props.GetDefault("SpaceBetween", "0")
        sSpaceBetween = UI.CStr(sSpaceBetween)
        bParallax = Props.GetDefault("Parallax", False)
        bParallax = UI.CBool(bParallax)
        bUpdateOnWindowResize = Props.GetDefault("UpdateOnWindowResize", True)
        bUpdateOnWindowResize = UI.CBool(bUpdateOnWindowResize)
        sTotalSlides = Props.GetDefault("TotalSlides", "")
        sTotalSlides = UI.CStr(sTotalSlides)
        sParentID = Props.GetDefault("ParentID", "")
        sParentID = UI.CleanID(sParentID)
        bAutoPlay = Props.GetDefault("AutoPlay", False)
        bAutoPlay = UI.CBool(bAutoPlay)
        iAutoPlayDelay = Props.GetDefault("AutoPlayDelay", 3000)
        iAutoPlayDelay = UI.CInt(iAutoPlayDelay)
        bAutoPlayDisableOnInteraction = Props.GetDefault("AutoPlayDisableOnInteraction", True)
        bAutoPlayDisableOnInteraction = UI.CBool(bAutoPlayDisableOnInteraction)
        bAutoPlayPauseOnMouseEnter = Props.GetDefault("AutoPlayPauseOnMouseEnter", False)
        bAutoPlayPauseOnMouseEnter = UI.CBool(bAutoPlayPauseOnMouseEnter)
        bAutoPlayReverseDirection = Props.GetDefault("AutoPlayReverseDirection", False)
        bAutoPlayReverseDirection = UI.CBool(bAutoPlayReverseDirection)
        bAutoPlayStopOnLastSlide = Props.GetDefault("AutoPlayStopOnLastSlide", False)
        bAutoPlayStopOnLastSlide = UI.CBool(bAutoPlayStopOnLastSlide)
        bAutoPlayWaitForTransition = Props.GetDefault("AutoPlayWaitForTransition", True)
        bAutoPlayWaitForTransition = UI.CBool(bAutoPlayWaitForTransition)
        bGrid = Props.GetDefault("Grid", False)
        bGrid = UI.CBool(bGrid)
        sGridFill = Props.GetDefault("GridFill", "column")
        sGridFill = UI.CStr(sGridFill)
        iGridRows = Props.GetDefault("GridRows", 1)
        iGridRows = UI.CInt(iGridRows)
        sPaddingAXYTBLR = Props.GetDefault("PaddingAXYTBLR","a=?; x=?; y=?; t=?; b=?; l=?; r=?")
        sPaddingAXYTBLR = UI.CStr(sPaddingAXYTBLR)
        sMarginAXYTBLR = Props.GetDefault("MarginAXYTBLR","a=?; x=?; y=?; t=?; b=?; l=?; r=?")
        sMarginAXYTBLR = UI.CStr(sMarginAXYTBLR)
        sRawClasses = Props.GetDefault("RawClasses", "")
        sRawClasses = UI.CStr(sRawClasses)
        sRawStyles = Props.GetDefault("RawStyles", "")
        sRawStyles = UI.CStr(sRawStyles)
        sRawAttributes = Props.GetDefault("RawAttributes", "")
        sRawAttributes = UI.CStr(sRawAttributes)
        iCardEffectPerSlideOffset = Props.GetDefault("CardEffectPerSlideOffset", 8)
        iCardEffectPerSlideOffset = UI.CInt(iCardEffectPerSlideOffset)
        iCardEffectPerSlideRotate = Props.GetDefault("CardEffectPerSlideRotate", 2)
        iCardEffectPerSlideRotate = UI.CInt(iCardEffectPerSlideRotate)
        bCardEffectRotate = Props.GetDefault("CardEffectRotate", True)
        bCardEffectRotate = UI.CBool(bCardEffectRotate)
        bCardEffectSlideShadows = Props.GetDefault("CardEffectSlideShadows", True)
        bCardEffectSlideShadows = UI.CBool(bCardEffectSlideShadows)
        iCoverFlowDepth = Props.GetDefault("CoverFlowDepth", 100)
        iCoverFlowDepth = UI.CInt(iCoverFlowDepth)
        iCoverFlowModifier = Props.GetDefault("CoverFlowModifier", 1)
        iCoverFlowModifier = UI.CInt(iCoverFlowModifier)
        iCoverFlowRotate = Props.GetDefault("CoverFlowRotate", 50)
        iCoverFlowRotate = UI.CInt(iCoverFlowRotate)
        iCoverFlowScale = Props.GetDefault("CoverFlowScale", 1)
        iCoverFlowScale = UI.CInt(iCoverFlowScale)
        bCoverFlowSlideShadows = Props.GetDefault("CoverFlowSlideShadows", True)
        bCoverFlowSlideShadows = UI.CBool(bCoverFlowSlideShadows)
        iCoverFlowStretch = Props.GetDefault("CoverFlowStretch", 0)
        iCoverFlowStretch = UI.CInt(iCoverFlowStretch)
        bCubeEffectShadow = Props.GetDefault("CubeEffectShadow", True)
        bCubeEffectShadow = UI.CBool(bCubeEffectShadow)
        iCubeEffectShadowOffset = Props.GetDefault("CubeEffectShadowOffset", 20)
        iCubeEffectShadowOffset = UI.CInt(iCubeEffectShadowOffset)
        dCubeEffectShadowScale = Props.GetDefault("CubeEffectShadowScale", 0.94)
        dCubeEffectShadowScale = UI.CDbl(dCubeEffectShadowScale)
        bCubeEffectSlideShadows = Props.GetDefault("CubeEffectSlideShadows", True)
        bCubeEffectSlideShadows = UI.CBool(bCubeEffectSlideShadows)
		sRawSlideImageStyle = Props.GetDefault("RawSlideImageStyle", "width=auto;max-width=100%;height=auto;max-height=100%;object-fit=cover")
        sRawSlideImageStyle = UI.CStr(sRawSlideImageStyle)
		sRawSlideStyle = Props.GetDefault("RawSlideStyle", "display=flex;position=relative;flex-direction=column;flex-shrink=0;align-items=center;justify-content=center;width=100%;height=100%;font-size=18px;text-align=center;box-sizing=border-box")
		sRawSlideStyle = UI.CStr(sRawSlideStyle)
		sRounded = Props.GetDefault("Rounded", "none")
		sRounded = UI.CStr(sRounded)
		If sRounded = "none" Then sRounded = ""
		sShadow = Props.GetDefault("Shadow", "none")
		sShadow = UI.CStr(sShadow)
		If sShadow = "none" Then sShadow = ""
		bCssMode = Props.GetDefault("CssMode", False)
		bCssMode = UI.cbool(bCssMode)
		bKeyboardEnabled = Props.GetDefault("KeyboardEnabled", False)
		bKeyboardEnabled = UI.CBool(bKeyboardEnabled)
		bMouseWheel = Props.GetDefault("MouseWheel", False)
		bMouseWheel = UI.CBool(bMouseWheel)
		sNextNavigation = Props.GetDefault("NextNavigation", "")
		sNextNavigation = UI.CStr(sNextNavigation)
		bOwnNavigation = Props.GetDefault("OwnNavigation", False)
		bOwnNavigation = UI.CBool(bOwnNavigation)
		sPrevNavigation = Props.GetDefault("PrevNavigation", "")
		sPrevNavigation = UI.CStr(sPrevNavigation)
    End If
	'
	'If sBackgroundColor <> "base-100" Then UI.AddBackgroundColorDT(sBackgroundColor)
	UI.AddClassDT("swiper")
	If sWidth <> "" Then UI.AddWidthDT(sWidth)
	If sHeight <> "" Then UI.AddHeightDT(sHeight)
	If sRounded <> "" Then UI.AddRoundedDT(sRounded)
	If sShadow <> "" Then UI.AddShadowDT(sShadow)
	Dim xattrs As String = UI.BuildExAttributes
	Dim xstyles As String = UI.BuildExStyle
	Dim xclasses As String = UI.BuildExClass
    '
	If sParentID <> "" Then
        'does the parent exist
        If BANano.Exists($"#${sParentID}"$) = False Then
            BANano.Throw($"${mName}.DesignerCreateView: '${sParentID}' parent does not exist!"$)
            Return
        End If
        mTarget.Initialize($"#${sParentID}"$)
    End If
    mElement = mTarget.Append($"[BANCLEAN]
    <div id="${mName}" class="${xclasses}" ${xattrs} style="${xstyles}">
    	<div id="${mName}_slides" class="swiper-wrapper"></div>
		<div id="${mName}_pagination" class="swiper-pagination hidden"></div>
		<div id="${mName}_prev" class="swiper-button-prev hidden"></div>
		<div id="${mName}_next" class="swiper-button-next hidden"></div>
		<div id="${mName}_scrollbar" class="swiper-scrollbar hidden"></div>
    </div>"$).Get("#" & mName)
    '
	Children.Initialize 
	Children.Put($"${mName}_slides"$, "SDUI5Text")
	Children.Put($"${mName}_pagination"$, "SDUI5Text")
	Children.Put($"${mName}_prev"$, "SDUI5Text")
	Children.Put($"${mName}_next"$, "SDUI5Text")
	Children.Put($"${mName}_scrollbar"$, "SDUI5Text")
	'
	If bHasPagination Then
		UI.SetVisibleByID($"${mName}_pagination"$, True)
	Else
		UI.RemoveElementByID($"${mName}_pagination"$)
	End If
    '
    If bHasNavigation Then
		If bOwnNavigation Then
			'remove existing navigation
			UI.RemoveElementByID($"${mName}_prev"$)
			UI.RemoveElementByID($"${mName}_next"$)
		Else	
			UI.SetVisibleByID($"${mName}_prev"$, True)
			UI.SetVisibleByID($"${mName}_next"$, True)
		End If
	Else
		UI.RemoveElementByID($"${mName}_prev"$)
		UI.RemoveElementByID($"${mName}_next"$)
    End If
    '
    If bHasScrollbar Then
		UI.SetVisibleByID($"${mName}_scrollbar"$, True)
	Else
		UI.RemoveElementByID($"${mName}_scrollbar"$)
	End If
    '
'    If mVisible = False Then setVisible(mVisible)
    If sTotalSlides <> "" Then
        Clear
        sTotalSlides = UI.CInt(sTotalSlides)
        Dim sCnt As Int
        For sCnt = 1 To sTotalSlides
            AddSlide
        Next
    End If
    '
    If sRawSlideImageStyle <> "" Then
        Dim rsis As Map = UI.GetKeyValues(sRawSlideImageStyle, True)
        AddSlideImageStyle(rsis)
    End If
    If sRawSlideStyle <> "" Then
		Dim rss As Map = UI.GetKeyValues(sRawSlideImageStyle, True)
        AddSlideStyle(rss)
    End If
    'On("activeIndexChange", Array("e"))
    'On("changeDirection", Array("e"))
    'On("click", Array("e"))
    'On("doubleClick", Array("e"))
    'On("doubleTap", Array("e"))
    'On("orientationchange", Array("e"))
    'On("progress", Array("e"))
    'On("reachBeginning", Array("e"))
    'On("reachEnd", Array("e"))
    'On("resize", Array("e"))
    'On("slideChange", Array("e"))
    'On("sliderMove", Array("e"))
	'On("tap", Array("e"))
	If sTotalSlides <> "" Then Refresh
End Sub

'set Next Navigation
Sub setNextNavigation(s As String)
	sNextNavigation = s
	CustProps.put("NextNavigation", s)
End Sub
'set Own Navigation
Sub setOwnNavigation(b As Boolean)
	bOwnNavigation = b
	CustProps.put("OwnNavigation", b)
End Sub
'set Prev Navigation
Sub setPrevNavigation(s As String)
	sPrevNavigation = s
	CustProps.put("PrevNavigation", s)
End Sub
'get Next Navigation
Sub getNextNavigation As String
	Return sNextNavigation
End Sub
'get Own Navigation
Sub getOwnNavigation As Boolean
	Return bOwnNavigation
End Sub
'get Prev Navigation
Sub getPrevNavigation As String
	Return sPrevNavigation
End Sub

Sub setKeyboardEnabled(b As Boolean)
	bKeyboardEnabled = b
	CustProps.put("KeyboardEnabled", bKeyboardEnabled)
End Sub

Sub getKeyboardEnabled As Boolean
	Return bKeyboardEnabled
End Sub

'set Card Effect Per Slide Offset
Sub setCardsEffectPerSlideOffset(i As Int)
    iCardEffectPerSlideOffset = i
    CustProps.put("CardEffectPerSlideOffset", i)
End Sub
'set Card Effect Per Slide Rotate
Sub setCardsEffectPerSlideRotate(i As Int)
    iCardEffectPerSlideRotate = i
    CustProps.put("CardEffectPerSlideRotate", i)
End Sub
'set Card Effect Rotate
Sub setCardsEffectRotate(b As Boolean)
    bCardEffectRotate = b
    CustProps.put("CardEffectRotate", b)
End Sub
'set Card Effect Slide Shadows
Sub setCardsEffectSlideShadows(b As Boolean)
    bCardEffectSlideShadows = b
    CustProps.put("CardEffectSlideShadows", b)
End Sub
'set Cover Flow Depth
Sub setCoverFlowEffectDepth(i As Int)
    iCoverFlowDepth = i
    CustProps.put("CoverFlowDepth", i)
End Sub
'set Cover Flow Modifier
Sub setCoverFlowEffectModifier(i As Int)
    iCoverFlowModifier = i
    CustProps.put("CoverFlowModifier", i)
End Sub
'set Cover Flow Rotate
Sub setCoverFlowEffectRotate(i As Int)
    iCoverFlowRotate = i
    CustProps.put("CoverFlowRotate", i)
End Sub
'set Cover Flow Scale
Sub setCoverFlowEffectScale(i As Int)
    iCoverFlowScale = i
    CustProps.put("CoverFlowScale", i)
End Sub
'set Cover Flow Slide Shadows
Sub setCoverFlowEffectSlideShadows(b As Boolean)
    bCoverFlowSlideShadows = b
    CustProps.put("CoverFlowSlideShadows", b)
End Sub
'set Cover Flow Stretch
Sub setCoverFlowEffectStretch(i As Int)
    iCoverFlowStretch = i
    CustProps.put("CoverFlowStretch", i)
End Sub
'set Cube Effect Shadow
Sub setCubeEffectShadow(b As Boolean)
    bCubeEffectShadow = b
    CustProps.put("CubeEffectShadow", b)
End Sub
'set Cube Effect Shadow Offset
Sub setCubeEffectShadowOffset(i As Int)
    iCubeEffectShadowOffset = i
    CustProps.put("CubeEffectShadowOffset", i)
End Sub
'set Cube Effect Shadow Scale
Sub setCubeEffectShadowScale(d As Double)
    dCubeEffectShadowScale = d
    CustProps.put("CubeEffectShadowScale", d)
End Sub
'set Cube Effect Slide Shadows
Sub setCubeEffectSlideShadows(b As Boolean)
    bCubeEffectSlideShadows = b
    CustProps.put("CubeEffectSlideShadows", b)
End Sub
'set Raw Slide Image Style
Sub setSlideImageStyle(s As String)
    sRawSlideImageStyle = s
    CustProps.put("RawSlideImageStyle", s)
End Sub
'set Raw Slide Style
Sub setSlideStyle(s As String)
    sRawSlideStyle = s
    CustProps.put("RawSlideStyle", s)
End Sub
'get Card Effect Per Slide Offset
Sub getCardEffectPerSlideOffset As Int
    Return iCardEffectPerSlideOffset
End Sub
'get Card Effect Per Slide Rotate
Sub getCardEffectPerSlideRotate As Int
    Return iCardEffectPerSlideRotate
End Sub
'get Card Effect Rotate
Sub getCardEffectRotate As Boolean
    Return bCardEffectRotate
End Sub
'get Card Effect Slide Shadows
Sub getCardEffectSlideShadows As Boolean
    Return bCardEffectSlideShadows
End Sub
'get Cover Flow Depth
Sub getCoverFlowDepth As Int
    Return iCoverFlowDepth
End Sub
'get Cover Flow Modifier
Sub getCoverFlowModifier As Int
    Return iCoverFlowModifier
End Sub
'get Cover Flow Rotate
Sub getCoverFlowRotate As Int
    Return iCoverFlowRotate
End Sub
'get Cover Flow Scale
Sub getCoverFlowScale As Int
    Return iCoverFlowScale
End Sub
'get Cover Flow Slide Shadows
Sub getCoverFlowSlideShadows As Boolean
    Return bCoverFlowSlideShadows
End Sub
'get Cover Flow Stretch
Sub getCoverFlowStretch As Int
    Return iCoverFlowStretch
End Sub
'get Cube Effect Shadow
Sub getCubeEffectShadow As Boolean
    Return bCubeEffectShadow
End Sub
'get Cube Effect Shadow Offset
Sub getCubeEffectShadowOffset As Int
    Return iCubeEffectShadowOffset
End Sub
'get Cube Effect Shadow Scale
Sub getCubeEffectShadowScale As Double
    Return dCubeEffectShadowScale
End Sub
'get Cube Effect Slide Shadows
Sub getCubeEffectSlideShadows As Boolean
    Return bCubeEffectSlideShadows
End Sub

'get Raw Slide Style
Sub getSlideStyle As String
    Return sRawSlideStyle
End Sub
'set Auto Play
Sub setAutoPlay(b As Boolean)
    bAutoPlay = b
    CustProps.put("AutoPlay", b)
End Sub
'set Auto Play Delay
Sub setAutoPlayDelay(i As Int)
    iAutoPlayDelay = i
    CustProps.put("AutoPlayDelay", i)
End Sub
'set Auto Play Disable On Interaction
Sub setAutoPlayDisableOnInteraction(b As Boolean)
    bAutoPlayDisableOnInteraction = b
    CustProps.put("AutoPlayDisableOnInteraction", b)
End Sub
'set Auto Play Pause On Mouse Enter
Sub setAutoPlayPauseOnMouseEnter(b As Boolean)
    bAutoPlayPauseOnMouseEnter = b
    CustProps.put("AutoPlayPauseOnMouseEnter", b)
End Sub
'set Auto Play Reverse Direction
Sub setAutoPlayReverseDirection(b As Boolean)
    bAutoPlayReverseDirection = b
    CustProps.put("AutoPlayReverseDirection", b)
End Sub
'set Auto Play Stop On Last Slide
Sub setAutoPlayStopOnLastSlide(b As Boolean)
    bAutoPlayStopOnLastSlide = b
    CustProps.put("AutoPlayStopOnLastSlide", b)
End Sub
'set Auto Play Wait For Transition
Sub setAutoPlayWaitForTransition(b As Boolean)
    bAutoPlayWaitForTransition = b
    CustProps.put("AutoPlayWaitForTransition", b)
End Sub
'set Grid
Sub setGrid(b As Boolean)
    bGrid = b
    CustProps.put("Grid", b)
End Sub
'set Grid Fill
'options: column|row
Sub setGridFill(s As String)
    sGridFill = s
    CustProps.put("GridFill", s)
End Sub
'set Grid Rows
Sub setGridRows(i As Int)
    iGridRows = i
    CustProps.put("GridRows", i)
End Sub
'get Auto Play
Sub getAutoPlay As Boolean
    Return bAutoPlay
End Sub
'get Auto Play Delay
Sub getAutoPlayDelay As Int
    Return iAutoPlayDelay
End Sub
'get Auto Play Disable On Interaction
Sub getAutoPlayDisableOnInteraction As Boolean
    Return bAutoPlayDisableOnInteraction
End Sub
'get Auto Play Pause On Mouse Enter
Sub getAutoPlayPauseOnMouseEnter As Boolean
    Return bAutoPlayPauseOnMouseEnter
End Sub
'get Auto Play Reverse Direction
Sub getAutoPlayReverseDirection As Boolean
    Return bAutoPlayReverseDirection
End Sub
'get Auto Play Stop On Last Slide
Sub getAutoPlayStopOnLastSlide As Boolean
    Return bAutoPlayStopOnLastSlide
End Sub
'get Auto Play Wait For Transition
Sub getAutoPlayWaitForTransition As Boolean
    Return bAutoPlayWaitForTransition
End Sub
'get Grid
Sub getGrid As Boolean
    Return bGrid
End Sub
'get Grid Fill
Sub getGridFill As String
    Return sGridFill
End Sub
'get Grid Rows
Sub getGridRows As Int
    Return iGridRows
End Sub
Sub setParentID(xParentID As String)
    sParentID = xParentID
    CustProps.Put("ParentID", xParentID)
End Sub
Sub AddSlides(numOf As Int)
    Dim sldCnt As Int
    For sldCnt = 1 To numOf
        AddSlide
    Next
End Sub
'add a slide
Sub AddSlide				'ignoredeadcode
    Dim nSlide As Int = items.Size + 1
    Dim sSlide As String = $"${mName}_${nSlide}"$
    BANano.GetElement($"#${mName}_slides"$).Append($"<div id="${sSlide}" class="swiper-slide ${mName}slide"></div>"$)
    items.Add(nSlide)
    Children.Put(sSlide, "SDUI5Text")
End Sub
'get a slide at a position
Sub Slide(pos As Int) As SDUI5SwiperSlide
    Dim sSlide As String = $"${mName}_${pos}"$
    Dim slidea As SDUI5SwiperSlide
    slidea.Initialize(mCallBack, sSlide, sSlide)
    slidea.LinkExisting
    Return slidea
End Sub
'set Centered Slides
Sub setCenteredSlides(b As Boolean)
    bCenteredSlides = b
    CustProps.put("CenteredSlides", b)
End Sub
'set Direction
'options: horizontal|vertical
Sub setDirection(s As String)
    sDirection = s
    CustProps.put("Direction", s)
End Sub
'set Effect
'options: slide|fade|cube|coverflow|flip|creative
Sub setEffect(s As String)
    sEffect = s
    CustProps.put("Effect", s)
End Sub
'set Has Navigation
Sub setHasNavigation(b As Boolean)
    bHasNavigation = b
    CustProps.put("HasNavigation", b)
End Sub
'set Has Pagination
Sub setHasPagination(b As Boolean)
    bHasPagination = b
    CustProps.put("HasPagination", b)
End Sub
'set Has Scrollbar
Sub setHasScrollbar(b As Boolean)
    bHasScrollbar = b
    CustProps.put("HasScrollbar", b)
End Sub

'set Width
Sub setWidth(s As String)
	sWidth = s
	CustProps.put("Width", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetWidth(mElement, sWidth)
End Sub

'get Width
Sub getWidth As String
	Return sWidth
End Sub

'set Height
Sub setHeight(s As String)
	sHeight = s
	CustProps.put("Height", s)
	If mElement = Null Then Return
	If s <> "" Then UI.SetHEight(mElement, sHeight)
End Sub

'get Height
Sub getHeight As String
	Return sHeight
End Sub

'set Init
Sub setInit(b As Boolean)
    bInit = b
    CustProps.put("Init", b)
End Sub
'set Initial Slide
Sub setInitialSlide(s As String)
    sInitialSlide = s
    CustProps.put("InitialSlide", s)
End Sub
'set Loop
Sub setLoops(b As Boolean)
    bLoops = b
    CustProps.put("Loops", b)
End Sub
'set Slides Per View
Sub setSlidesPerView(s As String)
    sSlidesPerView = s
    CustProps.put("SlidesPerView", s)
End Sub
'set Space Between
Sub setSpaceBetween(s As String)
    sSpaceBetween = s
    CustProps.put("SpaceBetween", s)
End Sub
'set Speed
Sub setSpeed(s As String)
    sSpeed = s
    CustProps.put("Speed", s)
End Sub
'set Update On Window Resize
Sub setUpdateOnWindowResize(b As Boolean)
    bUpdateOnWindowResize = b
    CustProps.put("UpdateOnWindowResize", b)
End Sub

Sub AddBreakPoint(bp As Int, slidesPerView As Double, spaceBetween As Int)
	Dim bpm As Map = CreateMap()
	If Options.ContainsKey("breakpoints") = False Then
		Options.Put("breakpoints", bpm)
	End If
	bpm = Options.get("breakpoints")
	'
	Dim bp1 As Map = CreateMap()
	bp1.Put("slidesPerView", slidesPerView)
	bp1.Put("spaceBetween", spaceBetween)
	bpm.Put(bp, bp1)
	Options.Put("breakpoints", bpm)
End Sub


'do refresh after adding all items to the swiper
Sub Refresh
	Options.Put("autoHeight", False)
	Options.Put("setWrapperSize", False)
	Options.Put("slidesOffsetBefore", 0)
	Options.Put("slidesOffsetAfter", 0)
	Options.put("touchEventsTarget", "container")
	Options.put("slidesPerGroup", 1)
	Options.put("slidesPerColumn", 1)
	Options.put("enabled", True)
	Options.put("slidesPerColumnFill", "column")
	UI.PutRecursive(Options,"freeMode.enabled", False)
	UI.PutRecursive(Options,"freeMode.momentum", True)
	UI.PutRecursive(Options,"freeMode.momentumRatio", 1)
	UI.PutRecursive(Options,"freeMode.momentumBounce", True)
	UI.PutRecursive(Options,"freeMode.momentumBounceRatio", 1)
	UI.PutRecursive(Options,"freeMode.momentumVelocityRatio", 1)
	UI.PutRecursive(Options,"freeMode.sticky", False)
	UI.PutRecursive(Options,"freeMode.minimumVelocity", 0.02)
	
	Options.Put("touchRatio", 1)
	Options.Put("touchAngle", 45)
	Options.Put("simulateTouch", True)
	Options.Put("touchStartPreventDefault", False)
	Options.Put("shortSwipes", True)
	Options.Put("longSwipes", True)
	Options.Put("longSwipesRatio", 0.5)
	Options.Put("longSwipesMs", 300)
	Options.Put("followFinger", True)
	Options.Put("threshold", 0)
	Options.Put("touchMoveStopPropagation", True)
	Options.Put("touchReleaseOnEdges", False)
	Options.Put("iOSEdgeSwipeDetection", False)
	Options.Put("iOSEdgeSwipeThreshold", 20)
	Options.Put("resistance", True)
	Options.Put("resistanceRatio", 0.85)
	Options.Put("watchSlidesProgress", False)
	Options.Put("watchSlidesVisibility", False)
	Options.Put("preventClicks", True)
	Options.Put("preventClicksPropagation", True)
	Options.Put("slideToClickedSlide", False)
	Options.Put("loopAdditionalSlides", 0)
	Options.Put("noSwiping", True)
	Options.Put("runCallbacksOnInit", True)
	'***
	Options.put("init", bInit)
	Options.put("speed", BANano.parseInt(sSpeed))
	Options.put("direction", sDirection)
	Options.put("loop", bLoops)
	Options.put("initialSlide", BANano.parseInt(sInitialSlide))
	Options.put("effect", sEffect)
	Options.put("parallax", bParallax)
	Options.put("updateOnWindowResize", bUpdateOnWindowResize)
	If sSlidesPerView = "auto" Then
		Options.put("slidesPerView", sSlidesPerView)
	Else
		sSlidesPerView = UI.CDbl(sSlidesPerView)
		Options.put("slidesPerView", BANano.parsefloat(sSlidesPerView))
	End If
	Options.put("spaceBetween", BANano.parseInt(sSpaceBetween))
	Options.put("centeredSlides", bCenteredSlides)
	Options.Put("cssMode", bCssMode)
	'
	Select Case sEffect
		Case "coverflow"
			UI.PutRecursive(Options, "coverflowEffect.depth", iCoverFlowDepth)
			UI.PutRecursive(Options, "coverflowEffect.modifier", iCoverFlowModifier)
			UI.PutRecursive(Options, "coverflowEffect.rotate", iCoverFlowRotate)
			UI.PutRecursive(Options, "coverflowEffect.scale", iCoverFlowScale)
			UI.PutRecursive(Options, "coverflowEffect.slideShadows", bCoverFlowSlideShadows)
			UI.PutRecursive(Options, "coverflowEffect.stretch", iCoverFlowStretch)
		Case "creative"
		Case "cube"
			UI.PutRecursive(Options, "cubeEffect.shadow", bCubeEffectShadow)
			UI.PutRecursive(Options, "cubeEffect.shadowOffset", iCubeEffectShadowOffset)
			UI.PutRecursive(Options, "cubeEffect.shadowScale", dCubeEffectShadowScale)
			UI.PutRecursive(Options, "cubeEffect.slideShadows", bCubeEffectSlideShadows)
		Case "fade"
		Case "flip"
			UI.PutRecursive(Options, "flipEffect.slideShadows", True)
			UI.PutRecursive(Options, "flipEffect.limitRotation", True)
		Case "cards"
			UI.PutRecursive(Options, "cardsEffect.perSlideOffset", iCardEffectPerSlideOffset)
			UI.PutRecursive(Options, "cardsEffect.perSlideRotate", iCardEffectPerSlideRotate)
			UI.PutRecursive(Options, "cardsEffect.rotate", bCardEffectRotate)
			UI.PutRecursive(Options, "cardsEffect.slideShadows", bCardEffectSlideShadows)
	End Select
	'
	UI.PutRecursive(Options, "zoom.maxRatio", 3)
	UI.PutRecursive(Options, "zoom.minRatio", 1)
	UI.PutRecursive(Options, "zoom.toggle", False)
	'
	UI.PutRecursive(Options, "a11y.prevSlideMessage", "Previous slide")
	UI.PutRecursive(Options, "a11y.nextSlideMessage", "Next slide")
	UI.PutRecursive(Options, "a11y.firstSlideMessage", "This is the first slide")
	UI.PutRecursive(Options, "a11y.lastSlideMessage", "This is the last slide")
	'
	If bAutoPlay Then
		Options.Put("autoplay", CreateMap())
		UI.PutRecursive(Options, "autoplay.delay", iAutoPlayDelay)
		UI.PutRecursive(Options, "autoplay.disableOnInteraction", bAutoPlayDisableOnInteraction)
		UI.PutRecursive(Options, "autoplay.pauseOnMouseEnter", bAutoPlayPauseOnMouseEnter)
		UI.PutRecursive(Options, "autoplay.reverseDirection", bAutoPlayReverseDirection)
		UI.PutRecursive(Options, "autoplay.stopOnLastSlide", bAutoPlayStopOnLastSlide)
		UI.PutRecursive(Options, "autoplay.waitForTransition", bAutoPlayWaitForTransition)
	End If
	'
	If bGrid Then
		Options.Put("grid", CreateMap())
		UI.PutRecursive(Options, "grid.fill", sGridFill)
		UI.PutRecursive(Options, "grid.rows", iGridRows)
	End If
	UI.PutRecursive(Options, "keyboard", bKeyboardEnabled)
	UI.PutRecursive(Options, "mousewheel", bMouseWheel)
	'
	If bHasPagination Then
		UI.PutRecursive(Options, "pagination.el", $"#${mName}_pagination"$)
		UI.PutRecursive(Options, "pagination.type", sPaginationType)
		UI.PutRecursive(Options, "pagination.dynamicBullets", bDynamicBullets)
		UI.PutRecursive(Options, "pagination.clickable", True)
		UI.PutRecursive(Options, "pagination.hideOnClick", True)
	End If
	'
	If bHasNavigation Then
		If bOwnNavigation Then
			UI.PutRecursive(Options, "navigation.nextEl", sNextNavigation)
			UI.PutRecursive(Options, "navigation.prevEl", sPrevNavigation)
			UI.PutRecursive(Options, "navigation.clickable", True)
		Else
			UI.PutRecursive(Options, "navigation.nextEl", $"#${mName}_next"$)
			UI.PutRecursive(Options, "navigation.prevEl", $"#${mName}_prev"$)
			UI.PutRecursive(Options, "navigation.clickable", True)
		End If
	End If
	'
	If bHasScrollbar Then
		UI.PutRecursive(Options, "scrollbar.el", $"#${mName}_scrollbar"$)
		UI.PutRecursive(Options, "scrollbar.hide", True)
	End If
	
	'save settings to localstorage
	Dim swiperJSON As String = BANano.ToJson(Options)
	BANano.SetLocalStorage2(mName, swiperJSON)
	'refresh the swiper
	Dim el As BANanoElement
    el.Initialize($"#${mName}"$)
    swiper.Initialize2("Swiper", Array(el.ToObject, Options))
End Sub

Sub slideNext
    swiper.RunMethod("slideNext", Null)
End Sub

Sub slidePrev
    swiper.RunMethod("slidePrev", Null)
End Sub

'get the name of a slide to use BANano.LoadLayout
Sub getSlideName(pos As Int) As String
    Dim sname As String = $"#${mName}_${pos}"$
    Return sname
End Sub
'
'set Parallax
Sub setParallax(b As Boolean)
    bParallax = UI.CBool(b)
    CustProps.put("Parallax", b)
End Sub
'
'set Pagination Type
'options: bullets|fraction|progressbar
Sub setPaginationType(s As String)
    sPaginationType = UI.CStr(s)
    CustProps.put("PaginationType", s)
End Sub
'
'set Total Slides
Sub setTotalSlides(s As String)
    sTotalSlides = UI.CStr(s)
    CustProps.put("TotalSlides", s)
End Sub
'
'set DynamicBullets
Sub setDynamicBullets(b As Boolean)
    bDynamicBullets = UI.CBool(b)
    CustProps.put("DynamicBullets", b)
End Sub
'
'get ParentID
Sub getParentID As String
    Return sParentID
End Sub
'
'get Parallax
Sub getParallax As Boolean
    Return bParallax
End Sub
'
'get Pagination Type
'options: bullets|fraction|progressbar
Sub getPaginationType As String
    Return sPaginationType
End Sub
'
'get Slides Per View
Sub getSlidesPerView As String
    Return sSlidesPerView
End Sub
'
'get Space Between
Sub getSpaceBetween As String
    Return sSpaceBetween
End Sub
'
'get Centered Slides
Sub getCenteredSlides As Boolean
    Return bCenteredSlides
End Sub
'
'get Direction
'options: horizontal|vertical
Sub getDirection As String
    Return sDirection
End Sub
'
'get Effect
'options: coverflow|creative|cube|fade|flip|slide
Sub getEffect As String
    Return sEffect
End Sub
'
'get Has Navigation
Sub getHasNavigation As Boolean
    Return bHasNavigation
End Sub
'
'get Has Pagination
Sub getHasPagination As Boolean
    Return bHasPagination
End Sub
'
'get Has Scrollbar
Sub getHasScrollbar As Boolean
    Return bHasScrollbar
End Sub
'
'get Speed
Sub getSpeed As String
    Return sSpeed
End Sub
'
'get Init
Sub getInit As Boolean
    Return bInit
End Sub
'
'get Initial Slide
Sub getInitialSlide As String
    Return sInitialSlide
End Sub
'
'get Total Slides
Sub getTotalSlides As String
    Return sTotalSlides
End Sub
'
'get Loop
Sub getLoop As Boolean
    Return bLoops
End Sub
'
'get DynamicBullets
Sub getDynamicBullets As Boolean
    Return bDynamicBullets
End Sub
'
'get Update On Window Resize
Sub getUpdateOnWindowResize As Boolean
    Return bUpdateOnWindowResize
End Sub

Sub AddSlideStyle(m As Map)					'ignoredeadcode
    UI.InsertCSSRule($".${mName}slide"$, m)
End Sub

Sub AddSlideImageStyle(m As Map)				'ignoredeadcode
    UI.InsertCSSRule($".${mName}slide img"$, m)
End Sub
'
'set Card Effect Per Slide Offset
Sub setCardEffectPerSlideOffset(i As Int)
    iCardEffectPerSlideOffset = UI.Cint(i)
    CustProps.put("CardEffectPerSlideOffset", i)
End Sub
'
'set Card Effect Per Slide Rotate
Sub setCardEffectPerSlideRotate(i As Int)
    iCardEffectPerSlideRotate = UI.Cint(i)
    CustProps.put("CardEffectPerSlideRotate", i)
End Sub
'
'set Card Effect Rotate
Sub setCardEffectRotate(b As Boolean)
    bCardEffectRotate = UI.CBool(b)
    CustProps.put("CardEffectRotate", b)
End Sub
'
'set Card Effect Slide Shadows
Sub setCardEffectSlideShadows(b As Boolean)
    bCardEffectSlideShadows = UI.CBool(b)
    CustProps.put("CardEffectSlideShadows", b)
End Sub
'
'set Cover Flow Depth
Sub setCoverFlowDepth(i As Int)
    iCoverFlowDepth = UI.Cint(i)
    CustProps.put("CoverFlowDepth", i)
End Sub
'
'set Cover Flow Modifier
Sub setCoverFlowModifier(i As Int)
    iCoverFlowModifier = UI.Cint(i)
    CustProps.put("CoverFlowModifier", i)
End Sub
'
'set Cover Flow Rotate
Sub setCoverFlowRotate(i As Int)
    iCoverFlowRotate = UI.Cint(i)
    CustProps.put("CoverFlowRotate", i)
End Sub
'
'set Cover Flow Scale
Sub setCoverFlowScale(i As Int)
    iCoverFlowScale = UI.Cint(i)
    CustProps.put("CoverFlowScale", i)
End Sub
'
'set Cover Flow Slide Shadows
Sub setCoverFlowSlideShadows(b As Boolean)
    bCoverFlowSlideShadows = UI.CBool(b)
    CustProps.put("CoverFlowSlideShadows", b)
End Sub
'
'set Cover Flow Stretch
Sub setCoverFlowStretch(i As Int)
    iCoverFlowStretch = UI.Cint(i)
    CustProps.put("CoverFlowStretch", i)
End Sub

'get Loops
Sub getLoops As Boolean
    Return bLoops
End Sub
'
'get Raw Slide Image Style
Sub getSlideImageStyle As String
    Return sRawSlideImageStyle
End Sub
